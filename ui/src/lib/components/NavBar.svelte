<script lang="ts">
	import { onMount } from 'svelte';
	import { gsap } from 'gsap';
	import { Navbar, NavBrand, NavLi, Dropdown, DropdownItem, Button } from 'flowbite-svelte';
	import { BarsOutline, SunSolid, MoonSolid, ArrowRightToBracketOutline } from 'flowbite-svelte-icons';

	let logoRef: HTMLDivElement;
	let isDarkMode = false;

	onMount(() => {
		// Animate the SVG logo with a drawing effect
		if (logoRef) {
			// Create the animation timeline
			const tl = gsap.timeline();

			// Get all SVG paths within the logo
			const paths = logoRef.querySelectorAll('path');

			// Set initial state - all paths with stroke-dashoffset
			paths.forEach(path => {
				if (path instanceof SVGPathElement) {
					const length = path.getTotalLength();
					gsap.set(path, {
						strokeDasharray: length,
						strokeDashoffset: length,
						fill: 'rgba(0,0,0,0)'  // Start with transparent fill
					});
				}
			});

			// Animate each path with a staggered effect
			tl.to(paths, {
				strokeDashoffset: 0,
				duration: 1.5,
				stagger: 0.1,
				ease: "power2.inOut"
			}).to(paths, {
				fill: 'currentColor',  // Fade in the fill color
				duration: 0.5,
				delay: -0.5
			});
		}

		// Initialize dark mode based on system preference or local storage
		const storedTheme = localStorage.getItem('color-theme');
		if (storedTheme === 'dark' || (!storedTheme && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
			document.documentElement.classList.add('dark');
			isDarkMode = true;
		} else {
			document.documentElement.classList.remove('dark');
			isDarkMode = false;
		}
	});

	function toggleDarkMode() {
		isDarkMode = !isDarkMode;
		if (isDarkMode) {
			document.documentElement.classList.add('dark');
			localStorage.setItem('color-theme', 'dark');
		} else {
			document.documentElement.classList.remove('dark');
			localStorage.setItem('color-theme', 'light');
		}
	}
</script>

<Navbar let:hidden fluid class="border-gray-200 bg-white px-4 py-2.5 dark:border-gray-700 dark:bg-gray-800 sm:px-6">
	<NavBrand href="/">
		<div bind:this={logoRef} class="h-8 w-8">
			<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" class="h-full w-full">
				<path d="M0 0 C9.91860237 5.26543089 18.24737411 12.37465451 24.47265625 21.69921875 C31.76626338 33.70259909 35.65684898 46.02119401 36.1328125 60.03125 C36.3826259 73.11044818 36.16849985 85.81733533 32.84765625 98.51171875 C32.54166504 99.69338623 32.54166504 99.69338623 32.22949219 100.89892578 C21.42009467 141.54823944 -3.15907902 174.46993377 -32.40234375 203.88671875 C-33.05162842 204.54075684 -33.70091309 205.19479492 -34.36987305 205.86865234 C-38.80064236 210.2842343 -43.39261413 214.45407254 -48.15234375 218.51171875 C-48.79042969 219.05650879 -49.42851563 219.60129883 -50.0859375 220.16259766 C-72.40850561 239.07477342 -96.5817691 255.31956115 -122.15234375 269.51171875 C-123.3751001 270.19596924 -123.3751001 270.19596924 -124.62255859 270.89404297 C-156.45058525 288.58178313 -156.45058525 288.58178313 -173.15234375 291.51171875 C-173.5390625 292.72085937 -173.92578125 293.93 -174.32421875 295.17578125 C-176.43943458 301.50910231 -178.91742696 307.69099834 -181.40234375 313.88671875 C-181.65911896 314.52744324 -181.91589417 315.16816772 -182.18045044 315.82830811 C-192.71426695 342.06824869 -203.9583149 367.99976845 -216.15234375 393.51171875 C-216.58321289 394.41873535 -217.01408203 395.32575195 -217.45800781 396.26025391 C-223.75496721 409.44996578 -230.95546043 422.03562736 -238.42333984 434.59375 C-241.36034747 439.55041692 -244.25544876 444.53153412 -247.15234375 449.51171875 C-246.42088135 449.78685303 -245.68941895 450.0619873 -244.93579102 450.34545898 C-242.3131197 451.44435389 -240.03438226 452.68225917 -237.6171875 454.171875 C-236.73998047 454.70949463 -235.86277344 455.24711426 -234.95898438 455.80102539 C-234.01216797 456.3861792 -233.06535156 456.97133301 -232.08984375 457.57421875 C-230.01571821 458.8452042 -227.94149511 460.11603047 -225.8671875 461.38671875 C-223.62889187 462.76169534 -221.390611 464.13669595 -219.15234375 465.51171875 C-160.49994541 503.52283606 -160.49994541 503.52283606 -93.7109375 519.71484375 C-75.296049 519.95191312 -59.44487403 517.70691303 -43.078125 508.84765625 C-30.71350438 501.29437336 -22.43315369 491.91156044 -15.39453125 479.3828125 C-9.9764086 468.50572708 -6.61402845 455.68865263 -6.15234375 443.51171875 C-6.10078125 442.27292969 -6.04921875 441.03414062 -5.99609375 439.7578125 C-5.54442286 423.55763332 -8.40820559 408.86257551 -15.78515625 394.28515625 C-20.05658354 386.56594011 -24.68864283 380.68809422 -32.02734375 375.76171875 C-38.46765 372.09288232 -44.25596092 370.33763197 -51.71875 370.21875 C-54.05096296 370.23845884 -56.38309054 370.27389314 -58.71484375 370.32421875 C-60.51405273 370.34452148 -60.51405273 370.34452148 -62.34960938 370.36523438 C-65.28433254 370.40031075 -68.21809257 370.44946448 -71.15234375 370.51171875 C-72.14234375 369.52171875 -73.13234375 368.53171875 -74.15234375 367.51171875 C-74.47131629 364.58780377 -74.59723441 362.38676487 -74.15234375 359.51171875 C-70.95853061 352.45106671 -65.2869918 347.07517635 -59.15234375 342.51171875 C-50.31834002 336.71488559 -39.38802682 333.88972342 -28.90625 333.125 C-15.59817379 332.57648113 -2.08853394 335.55358709 9.84765625 341.51171875 C25.75231904 350.13180316 38.38932663 362.75387672 48.05859375 377.9140625 C59.63243543 397.27031496 66.57713447 419.24171076 67.1484375 441.859375 C67.1679264 444.4309187 67.17138591 447.00262572 67.16015625 449.57421875 C67.1580011 450.25047302 67.15584595 450.92672729 67.15362549 451.62347412 C67.02681729 476.54604995 61.83196048 500.07494603 50.84765625 522.51171875 C50.55165527 523.13208008 50.2556543 523.75244141 49.95068359 524.39160156 C42.90238206 539.03653278 33.05848532 551.79130654 21.84765625 563.51171875 C21.22890625 564.18203125 20.61015625 564.85234375 19.97265625 565.54296875 C3.28591098 583.06405128 -19.27181529 594.93440864 -42.27734375 601.76171875 C-69.93695706 609.4995548 -98.53999605 609.5846771 -126.40771484 602.86987305 C-130.35613389 601.85652956 -134.25847817 600.71665017 -138.15234375 599.51171875 C-138.90128906 599.28033203 -139.65023438 599.04894531 -140.421875 598.81054688 C-160.01353772 592.56760772 -178.78517933 582.67545771 -195.48144531 570.70898438 C-197.20207811 569.47608209 -198.93724731 568.26609503 -200.67578125 567.05859375 C-214.07365502 557.69355566 -226.69132118 547.32406817 -239.34375 536.98828125 C-240.94469855 535.68124334 -242.54832351 534.37748519 -244.15234375 533.07421875 C-249.02991778 529.10410036 -253.8581341 525.08167883 -258.65234375 521.01171875 C-266.97522714 513.94820286 -275.33435315 506.95466317 -284.15234375 500.51171875 C-284.40113281 501.06859375 -284.64992188 501.62546875 -284.90625 502.19921875 C-297.2029972 525.0195145 -322.84095667 544.92139385 -344.15234375 558.51171875 C-364.73326702 570.81945948 -386.843091 578.60955153 -410.93359375 579.6796875 C-431.60026254 579.78823093 -451.14843889 576.90071603 -469.38085938 566.58056641 C-473.6811979 563.98590239 -477.45841701 560.89667392 -481.15234375 557.51171875 C-481.78398437 556.94839844 -482.415625 556.38507812 -483.06640625 555.8046875 C-491.99476021 547.40731494 -498.47121001 536.44411761 -502.37890625 524.8828125 C-507.21826216 508.46729946 -507.27090273 493.06226466 -503.48046875 476.48828125 C-498.76695415 457.81551188 -488.67638621 442.30209822 -475.46484375 428.44921875 C-460.47846943 413.87343003 -441.0887249 405.12322076 -421.03857422 399.96826172 C-393.82071632 393.52680863 -366.31352574 398.00373537 -339.97265625 405.7265625 C-334.07788772 407.50300277 -328.28260008 409.46937554 -322.53125 411.6640625 C-320.25925055 412.62360222 -320.25925055 412.62360222 -318.15234375 412.51171875 C-302.14339216 380.90869986 -286.66008394 349.27546983 -273.15234375 316.51171875 C-274.16321045 316.5274292 -275.17407715 316.54313965 -276.21557617 316.55932617 C-331.76883738 317.34571967 -331.76883738 317.34571967 -355.1015625 304.7578125 C-359.25562576 302.23372454 -362.3246461 299.78085515 -365.02734375 295.63671875 C-366.34849992 291.96684051 -366.57515052 289.38744748 -366.15234375 285.51171875 C-364.90234375 282.69921875 -364.90234375 282.69921875 -363.15234375 280.51171875 C-361.51953125 279.32421875 -361.51953125 279.32421875 -359.15234375 278.51171875 C-356.53642288 278.66474723 -354.10280615 278.91922607 -351.52734375 279.32421875 C-340.38415252 280.94247947 -329.49127505 281.7487938 -318.21484375 281.76171875 C-317.1716246 281.76372787 -317.1716246 281.76372787 -316.10733032 281.76577759 C-295.56429937 281.75728692 -275.37089035 278.9840879 -255.15234375 275.51171875 C-254.99765625 274.51543457 -254.99765625 274.51543457 -254.83984375 273.49902344 C-253.97640068 269.74721613 -252.59180722 266.2733131 -251.15234375 262.71484375 C-250.69127983 261.56110008 -250.69127983 261.56110008 -250.22090149 260.38404846 C-249.20284909 257.84131552 -248.17799732 255.30139434 -247.15234375 252.76171875 C-246.43249509 250.97226573 -245.71268784 249.18279605 -244.99291992 247.39331055 C-174.04142759 71.29637671 -174.04142759 71.29637671 -111.62890625 21.66796875 C-94.04076563 8.10585789 -73.60375912 -2.48062761 -51.515625 -6.0546875 C-34.07996004 -8.06034268 -16.1826388 -7.25278428 0 0 Z M-46.65234375 38.69921875 C-48.16394311 39.95623296 -49.66365149 41.22765773 -51.15234375 42.51171875 C-51.94382812 43.15882813 -52.7353125 43.8059375 -53.55078125 44.47265625 C-105.24524168 88.33956431 -129.00956839 175.94175841 -151.15234375 237.51171875 C-150.82234375 238.17171875 -150.49234375 238.83171875 -150.15234375 239.51171875 C-131.31434518 228.26152233 -113.64872327 215.99345422 -97.15234375 201.51171875 C-96.42015625 200.87878906 -95.68796875 200.24585938 -94.93359375 199.59375 C-93.64526134 198.476684 -92.36245229 197.35320781 -91.0859375 196.22265625 C-89.71322827 195.00801657 -88.3291741 193.80614477 -86.9375 192.61328125 C-65.09651189 173.56878919 -47.43450092 149.60837661 -33.15234375 124.51171875 C-32.81251465 123.92777344 -32.47268555 123.34382813 -32.12255859 122.7421875 C-20.4356055 102.57646452 -12.92385095 80.72929326 -12.71484375 57.32421875 C-12.70453125 56.36789551 -12.69421875 55.41157227 -12.68359375 54.42626953 C-12.75946709 48.44808241 -13.67287503 43.96290367 -16.15234375 38.51171875 C-17.8930698 35.9287059 -19.42048339 34.06061402 -21.90234375 32.19921875 C-30.9887943 29.4228033 -39.4282094 33.22059834 -46.65234375 38.69921875 Z M-421.90234375 454.26171875 C-428.56790198 459.0073064 -433.52058157 464.67105414 -437.02734375 472.07421875 C-440.56100735 480.66447167 -441.9182735 488.15996362 -441.15234375 497.51171875 C-440.2498706 502.73785871 -438.31968365 506.6763288 -435.02734375 510.82421875 C-431.94235598 514.03748044 -428.96769604 516.29634645 -424.79296875 517.88671875 C-418.19072221 519.44938065 -411.58904631 519.22523562 -404.97265625 517.8515625 C-390.02070899 513.36597832 -377.47884296 502.42309731 -366.75390625 491.42578125 C-357.50079412 481.06118418 -350.00707709 469.5594319 -343.15234375 457.51171875 C-346.49747175 454.70181123 -350.12411665 453.09142567 -354.15234375 451.51171875 C-354.81443848 451.25044189 -355.4765332 450.98916504 -356.15869141 450.7199707 C-364.88900226 447.35933579 -373.79205058 445.06131395 -383.15234375 444.51171875 C-383.84457031 444.47046875 -384.53679687 444.42921875 -385.25 444.38671875 C-398.49674956 444.00205815 -410.63713583 447.3174125 -421.90234375 454.26171875 Z " fill="currentColor" stroke="currentColor" stroke-width="2" transform="translate(714.15234375,175.48828125)"/>
			</svg>
		</div>
		<span class="pl-4 text-2xl">Lyn</span>
	</NavBrand>
	<div class="flex md:order-2">
		<Button on:click={toggleDarkMode} color="none" class="p-2 text-gray-600 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700">
			{#if isDarkMode}
				<SunSolid class="w-5 h-5" />
			{:else}
				<MoonSolid class="w-5 h-5" />
			{/if}
		</Button>
		<Button href="/login" class="ml-3">
			<ArrowRightToBracketOutline class="w-5 h-5 mr-2" />Sign in
		</Button>
			<BarsOutline class="w-6 h-6" />
			<span class="sr-only">Open main menu</span>
	</div>
</Navbar>
